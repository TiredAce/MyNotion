## 第4章 复合类型

### 4.1 数组

#### 4.1.3 C++11数组初始化方法

​		首先，初始化数组时，可以省略等号

```c++
double earings[4] {1, 2, 3, 4};
```

​		其次，可以不在大括号内包含的任何东西，表示将所有的元素都设置为零。

```c++
double earing[4] {};
```

​		最后，列表的初始化禁止缩窄转换。

```c++
long arr1[] = {25. 93. 1.0};             // no
char arr2[4] = {'h', 'i', 17772. '\0'};  // no
char arr3[4] = {'h', 'i', 17, '\0'};     // yes
```

### 4.2 字符串

#### 4.2.1 拼接字符串常量
​		以下赋值语句是等效的：
```c++
char name[20] = "abc"" efg";
char name[20] = "abc efg";
```
​		第一种方式为字符串常量的拼接，第一个字符串的`/0`字符将被第二个字符串的第一个字符取代。

#### 4.2.3 字符串输入

​		`cin`使用空白来确定字符串的结束位置，这意味着`cin`在获取字符数组输入时只读取一个单词。读取该单词后，`cin`将该字符串放到数组中，并自动在结尾添加空字符。另一个问题是，输入字符串可能比目标数组长。

#### 4.2.4 每次读取一行字符串

​		要将整条短语而不是一个单词作为字符串输入，需要采用另一种字符串读取方法。在`istream`中的类提供了一些面向行的类成员函数：`getline()`和`get()`。这两个函数都读取一行输入，直到到达换行符。然而，随后`getline()`将对其换行符，而`get()`将换行符保留在输入序列中。

##### 1. 面向行的输入： getline()

​		`getline()`函数读取整行，它使用通过回车键输入的换行符来确定输入结尾。要调用这种方法，可以使用`cin.getline()`。该函数有两个 参数。第一个参数是用来存储输入行的数组的名称，第二个参数是要读取的字符数。如果这个此参数为20，则这个函数最多读取19个字符，余下的空间用于存储自动在结尾处添加的空字符。`getline()`成员函数在读取指定数目的字符或遇到换行符时停止读取。

​		例如，假设要使用`getline()`将姓名读入到一个包含20个元素的`name`数组中。可以通过：

```c++
cin.getline(name, 20);
```

​		这将把一行读入到`name`数组中——如果这行包含的字符不超过19个。

##### 2. 面向行的输入：get()

​		`istream`类有另一个名为`get()`的成员函数，该函数有几种变体。其中一种变体的工作方式与`getline()`类似，它们接受的参数相同，解释参数的方式也相同，并且都去读到行尾。但`get`并不再读取并丢弃换行符，而是将其留在输入队列中。假设连续使用两次调用`get()`:

```c++
cin.get(name, 20);
cin.get(dessert, 20);     // a problem
```

​		第一次调用时，换行符留在输入队列中，因此第二次调用时，看到的第一个字符是换行符。因此`get()`认为已到达行尾，而没有发现任何可读取的内容。如果哦不借助帮助，`get()`将不能跨过该换行符。

​		可以通过`get()`的一种变体。使用不带任何参数的`cin.get()`调用可读取下一个字符，因此此可以用它来读取换行符，为读取下一行输入做好准备。

```c++
cin.get(name, 20);
cin.get(); 				 // read newline
cin.get(dessert, 20); 
```

​		另一种使用`get()`的方式是将两个类成员函数拼接起来，如下：

```c++
cin.get(name, ArSize).get();
```

​		之所以能这样做啊，是由于` cin.get(name, ArSize)`返回一个`cin`对象，该对象随后将被用来调用`get()`函数。同样，下面的语句将把输入中连续的两行分别读入数组`name1`和`name2`中，效果调用两次`cin.getline()`相同。

```c++
cin.getline(name1, ArSize).getline(name2, ArSize);
```

##### 3. getline()和get()比较

​		为什么要使用`get()`，而不是`getline()`？首先，老式实现没有`getline()`。其次，`get()`使输入更仔细。例如，用`get()`将一行读入数组中。如何直到停止读取的原因是由于已经读取了整行，而不是由于数组已经填满？只需要查看下一个输入字符，如果是换行符，说明读取了一整行；否则，说明该行中还有其他输入。**总之，`getline()`使用起来简单一些，但`get()`使得检查错误更简单些**。可以用任意方法读取，只是应该知道，它们的行为稍微有不同。

### 4.3 string类简介

#### 4.3.4 string类I/O

​		使用`cin`读取`string`类对象每次读取一行而不是一个单词，使用的语法不同。将一行输入读取到数组中的代码：

```c++
cin.getline(charr, 20);
```

​		这种句点表示法表明，函数`getline()`是`istream`类的一个类方法。

​		下面将一行输入读取到`string`对象中的代码：

```c++
getline(cin, str);
```

​		这里没用使用句点表示法，这表明这个`getline()`不是类方法。它将`cin`作为参数，指出到哪里去查找输入。另外也没有指出字符串长度参数，因为`string`对象将根据字符串的长度自动调整自己的大小。

​		那么，为何一个`getline()`是`istream`的类方法，而另一个不是呢？在引入`string`类之前很久，`C++`就有`istream`类。因此`istream`的设计考虑到了基本数据类型，但没有考虑`string`类型，所以`istream`类中，有处理基本数据类型的方法，没有处理`string`类型的方法。该处理方式使用了`string`类的一个友元函数。

#### 4.3.5 其他形式的字符串字面值

​		使用前缀表示不同的字符串类型：

```c++
wchar_t title[] = L"Chief";     // w_char string
char16_t name[] = u"Ripova";    // char16_t string
char32_t car[] = U"Super";      // char32_t string
```

​		`C++11`新增的另一种类型是原始字符串。在原始字符串中，字符串就是本身，转义字符不会转义。当然，既然可以在字符串字面量包含`"`，就不能再使用它来表示字符串的开头和末尾。因此，原始字符串将`"(`和`)"`用作定界符，并使用前缀`R`来标识原始字符串：

```c++
cout << R"(Jim "King" Tutt uses "\n" instead of endl.)" << '/n';
```

### 4.4 结构简介

#### 4.4.2 C++11结构初始化

​		与数组一样，`C++11`也支持将列表初始化用于结构，且等号是可选的：

```c++
inflatable duck {"Daphne", 0.12, 9.98};   // can omit the = in C++11
```

​		其次，如果大括号内未包含任何东西，各个成员都将被设置为零。**最后，不允许缩窄转换。**

 #### 4.4.4 其他结构属性

​		可以使用赋值运算符`=`将结构给另一个同类型的结构，这样结构中每个成员都将被设置为另一个结构中相应成员的值，即使成员是数组。这种赋值被称为成员赋值。



P94
