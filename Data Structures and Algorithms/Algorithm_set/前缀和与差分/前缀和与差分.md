# Part1 前缀和与差分

>[1. 前缀和](#1)
>
>[2. 差分](#2)
>
>[3. 习题](#3)

<h2 id = "1">
1. 前缀和
</h2>

对于给定的一个数列$A$，它的前缀和数列$S$是通过地推求出的基本信息：
$$
S[i] = \sum^{i}_{j = 1}A[j]
$$
一部分和，即数列$A$某个下标区间内的数的和，可表示为前缀和相减的形式：
$$
sum(l, r) = \sum^{r}_{i = l} A[i] = S[r] - S[l - 1]
$$
<h2 id = "2">
2. 差分
</h2>
对于一个给定的数组$A$，它的差分数列$B$定义为：
$$
B[1] = A[1],\ B[i] = A[i] - A[i- 1](2 \le i \le n)
$$
容易发现其实前缀和与差分是一对逆运算，差分序列$B$的前缀和序列就是原序列$A$，前缀和序列$S$的差分序列也就是原序列$A$。差分最重要的运用就是将区间操作转化为在单点的操作，将时间复杂度从$O(n)$降到$O(1)$。

差分不仅能运用在序列上，也能在树的结构上使用，也就是树上差分。


<h2 id = "3">
3. 习题
</h2>
>[1. 增减序列(差分)](#3.1)
>
>[2. 最高的牛](#3.2)

<h3 id="3.1">
3.1 增减序列
</h3>
**题目描述**：给定一个长度为 $n$ 的数列 $a_1,a_2,…,a_n$每次可以选择一个区间 $[l,r]$，使下标在这个区间内的数都加一或者都减一。

求至少需要多少次操作才能使数列中的所有数都一样，并求出在保证最少次数的前提下，最终得到的数列可能有多少种。

**思路**：对于区间操作很容易想到使用差分，结果要保证所有的数都相等，也就是等价于保证差分数组中下标$2$~$n$的数组为$0$。再回到操作部分，可以分为三种类型的操作，对前缀加减一，对中间区间加减一，对后缀加减一。第一种类型，由于差分数组的第一位无论是多少都可以，因此该操作等价于对某个位置加减一；第二种类型，对数组内部进行操作，一个数加对应一个数减；最后一种操作在本质上与第一种操作一致，因此无需再考虑。最后，问题就转化为计算差分数组中正数和负数大小的比较，最终最少的步数就是$min(neg, pos) + |neg - pos|$,其中$neg$表示负数绝对值的总和，$pos$表示正数总和。对于方案数其实就是看操作一和操作二的做了几次，因为它们可以等价替换，结果为$|neg -pos| + 1$。

[Code:3_1.cpp]()

<h3 id="3.2">
3.2 最高的牛
</h3>

**题目描述**：有 $N$头牛站成一行，被编队为 $1、2、3…N$，每头牛的身高都为整数。

当且仅当两头牛中间的牛身高都比它们矮时，两头牛方可看到对方。

现在，我们只知道其中最高的牛是第 $P$ 头，它的身高是 $H$ ，剩余牛的身高未知。

但是，我们还知道这群牛之中存在着 $M$ 对关系，每对关系都指明了某两头牛 $ A$ 和 $B$ 可以相互看见。

求每头牛的身高的最大可能值是多少。

- 此题中给出的关系对可能存在重复

**思路**：首先假设所有的牛都是最高的，然后通过$M$对关系，如果两头牛能相互看见，那么就说明它们之间的牛是都比它们两个低。根据上述性质能够得出，对于任意两对关系，要不这两个区间不相交，要不就是包含关系。那么如何考虑重复的关系，只需要记录并去重即可。

[Code:3_2.cpp]()