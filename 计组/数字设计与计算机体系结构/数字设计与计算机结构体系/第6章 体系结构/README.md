## 第6章 体系结构

>[6.2 汇编语言](#6.2)

<h3 id = "6.2">
6.2 汇编语言
</h3>

汇编语言是计算机机器语言的人类可阅读表示。每条汇编语言指令都指明了需要完成的操作和操作所处理的操作数。简单介绍的计算指令并说明，如何用汇编语言编写这些操作。然后定义$MIPS$指令操作数：寄存器、存储器和常数。

#### 6.2.1 指令

最常见的计算操作是加法。以下展示汇编代码的加法与减法。

```assembly
add a, b, c   # a = b + c;
sub a, b, c   # a = b - c;
```

汇编指令的第一部分`add`是助记符，它指明需要执行的操作。该操作基于源操作数$b$和$c$，将结果写入目标的操作数。

减法指令类似于加法，除了操作码`sub`以外，指令格式完全与加法指令相同，这种一致的指令格式很好地证明了第一个设计准则：

*设计准则1：简单设计有助于规整化。*

指明中包含固定数目的操作数将将易于编码和硬件处理。更加复杂的高级语言代码可以转换为多条指令。使用多条汇编指令执行复杂的操作体现了计算机体系结构的第二个设计准则：

*设计准则2：加快常见功能。*

#### 6.2.2 操作数：寄存器、存储器和常数

一条指令的操作需要基于操作数。上述中的变量都是操作数。但是计算机只能处理二进制，而不能处理变量名。指令需要从一个物理位置中取出二进制数据。操作数可以存放在寄存器或存储器中，也可以作为常数存储在指令自身中。计算机使用不同的位置存放操作数以便优化性能和存储容量。访问存放在指令中的常数或者寄存器中的操作数非常快，但是它们只能包含少量数据。更多的数据是从存储器中得到的，但访问速度相较于寄存器较慢。

1. 寄存器

只有快速访问操作数，指令才能快速执行，但是存放在存储器中的操作数需要较长时间才能访问到。因此，体系结构定义了几个寄存器用于存放常用的操作数。`MIPS`体系结构有`32`个寄存器，称为寄存器集或寄存器文件。寄存器越少访问速度越快。这体现第三个设计准则：

*设计准则3：越小的设计越快。*

`MIPS`寄存器名由`$`符号开始。变量`a`、`b`和`c`存放到`$s0`、`$s1`和`$s2`中。`MIPS`有32个寄存器，其中使用18个寄存器存储变量`$s0~$s7`和`$t0~$t9`。由`$s`开头的寄存器称为保存寄存器。指令示例：

```assembly
# a = b + c;
# $s0 = a, $s1 = b, $s2 = c
add $s0, $s1, $s2
```

```assembly
# a = b + c - d;
# $s0 = a, $s1 = b, $s2 = c, $s3 = d
sub $t0, $s2, $s3
add $s0, $s1, $t1
```

2. 寄存器集

`MIPS`定义了32个寄存器。每个寄存器都有一个名字和编号。`$0`始终为`0`，因为常数`0`经常在计算机程序中使用。
